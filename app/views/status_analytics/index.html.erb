<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<h2>ðŸ“Š Status Analytics Dashboard</h2>

<div class="splitcontentleft">
  <div class="box">
    <h3>Total Workload: <span style="color:#778899"><%= @toplam %></span></h3>
    <hr>
    <table class="list issues odd-even">
      <thead>
        <tr>
          <th>Status Name</th>
          <th>Count</th>
        </tr>
      </thead>
      <tbody>
        <% @dagilim.each do |durum, sayi| %>
          <tr class="issue">
            <td><strong><%= durum.name %></strong></td>
            <td><%= sayi %></td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>

<div class="splitcontentright">
  <div class="box">
    <h3>Status Distribution Chart</h3>
    <div style="height: 300px;">
      <canvas id="myPieChart"></canvas>
    </div>
  </div>
</div>

<script>
  const ctx = document.getElementById('myPieChart').getContext('2d');
  new Chart(ctx, {
    type: 'pie',
    data: {
      labels: <%= raw @etiketler.to_json %>,
      datasets: [{
        data: <%= @veriler.to_json %>,
        backgroundColor: [
          '#FFB7B2', 
          '#B2E2F2', 
          '#B2F2BB', 
          '#FDFD96', 
          '#E0BBE4', 
          '#FFDAC1', 
          '#C7CEEA'  
        ],
        borderWidth: 1,
        borderColor: '#ffffff'
      }]
    },
    options: { 
      responsive: true, 
      maintainAspectRatio: false,
      plugins: {
        legend: {
          position: 'bottom'
        }
      }
    }
  });
</script>

